%!TEX root = rapport.tex

\subsection{Sift algorithm variations}
As described in Section~\ref{sec:heap:sifting} two different strategies for sifting have been implemented. The one uses $\leq V$ space and reads/writes backwards, whereas the other requires $\leq 2V$ space but only reads forwards.

We choose to do a small experiment\todo{More details about the test?} for all our streams with these two sifting implementations, as we were unsure about the penalty (if any) obtained by doing IO backwards.

Doing the tests it was found that the space efficient implementation consistently had a better running time\todo{Decribe how much better?}. Hence this has been chosen for all the following experiments.

\subsection{Parameter weeding}
As described in Section~\ref{sec:implementation:parameters}, the implemented heap has a lot of adjustable parameters, which all may have an influence on its performance. In order to limit the time needed for running experiments, the parameters space has been weeded out, such that it does not include obviously bad settings.

We have only considered settings of parameters satisfying the following constraints:
\begin{equation}
  \label{eqn:memory}
  \frac{1}{4}M \leq V + 2P \ceil*{\frac{N}{V}} + (d + 1)B \leq M
\end{equation}
\begin{equation}
  \label{eqn:fanout}
  \frac{1}{4} \frac{V}{P} \leq d \leq 4 \frac{V}{P}
\end{equation}
Constraint~\ref{eqn:memory} says that all buffers used by the heap should fit into main memory\todo{Explain?}. If this was not the case, memory trashing would occour, giving more IOs than anticipated. Moreover parameter values have been grown by a factor of $2$.


Nots:
Good for sifting to reduce the height $h$ of the tree, since sifting can be called recursively for each level. No penalty other than space consumption for having a low tree.

The height is given by $h = \log_d{\frac{N}{V}} = \log_d{N} - \log_d{V}$. So note that $d$ is more significant for the tree height than the block size $V$.

\subsection{Streams}



% TODO: Find konfigurationer

\subsection{Cached stream}

\subsection{Heap}

% TODO: Med de bedste stream konfigurationer + cached

\subsection{Comparison}